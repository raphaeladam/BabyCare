using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace BabySitter
{
    public partial class ParentReg : System.Web.UI.Page
    {
        DataConnectionDataContext dc;
        protected void Page_Load(object sender, EventArgs e)
        {
            dc = Connection.GetDataContextInstance();
        }

        protected void Button1_Click(object sender, EventArgs e)
        {
            Parent p1 = new Parent();
            User u2 = new User();
            try
            {
                u2.UserName = userName.Text;
                u2.Password = password.Text;
                p1.UserName = userName.Text;
                p1.FirstName = fName.Text;
                p1.LastName = lastName.Text;
                p1.StreetName = streetName.Text;
                p1.StreetNumber = int.Parse(streetNumber.Text);
                p1.City = cities.Text;
                p1.Email = Email.Text;
                p1.PhoneNumber = phone.Text;
                p1.BirthDate = DateTime.Parse(birthDate.Text);
                dc.Users.InsertOnSubmit(u2);
                dc.Parents.InsertOnSubmit(p1);
                dc.SubmitChanges();
                ScriptManager.RegisterStartupScript(this, GetType(), "theAlertName", "alert(\"Update Succesfull!\");", true);
            }
            catch
            {
                if (userName.Text == "" || password.Text == "" || fName.Text == "" || lastName.Text == "" || streetName.Text == "" || streetNumber.Text == "" || cities.Text == "" || Email.Text == "" || phone.Text == "" || birthDate.Text == "")
                    ScriptManager.RegisterStartupScript(this, GetType(), "theAlertName", "alert(\"Please Fill All Areas!\");", true);
                else
                    ScriptManager.RegisterStartupScript(this, GetType(), "theAlertName", "alert(\"User Allready Exist!\");", true);
            }
        }
    }
}